<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <title>前端调用后端接口</title>
    </head>
    <body>
        <h3>GET请求测试</h3>
        <button onclick="sendGetRequest()">发送GET请求</button>
        <p id="getResult">GET请求结果：</p>

        <hr />

        <h3>POST请求测试（JSON格式）</h3>
        <button onclick="sendPostRequest()">发送POST请求</button>
        <p id="postResult">POST请求结果：</p>

        <script>
            // 1. 发送GET请求（携带参数）
            function sendGetRequest() {
                // 拼接参数到URL后：?参数1=值1&参数2=值2
                const url =
                    "http://127.0.0.1:5000/api/get_data?username=张三&age=20";
                fetch(url, {
                    method: "GET", // 请求方式为GET
                    headers: {
                        "Content-Type": "application/json",
                    },
                })
                    .then((response) => response.json()) // 解析后端返回的JSON数据
                    .then((data) => {
                        // 将结果显示在页面上
                        document.getElementById(
                            "getResult"
                        ).innerText = `GET请求结果：${JSON.stringify(
                            data,
                            null,
                            2
                        )}`;
                        console.log("GET请求返回数据：", data);
                    })
                    .catch((error) => {
                        console.error("GET请求失败：", error);
                        document.getElementById("getResult").innerText =
                            "GET请求失败：" + error;
                    });
            }

            // 2. 发送POST请求（JSON格式携带参数）
            function sendPostRequest() {
                const url = "http://127.0.0.1:5000/api/post_data";
                // 要传递的参数（JSON对象）
                const postData = {
                    username: "李四",
                    password: "123456",
                    hobby: ["篮球", "编程"],
                };

                fetch(url, {
                    method: "POST", // 请求方式为POST
                    headers: {
                        "Content-Type": "application/json", // 声明请求体为JSON格式
                    },
                    body: JSON.stringify(postData), // 将JSON对象转为字符串传递
                })
                    .then((response) => response.json())
                    .then((data) => {
                        document.getElementById(
                            "postResult"
                        ).innerText = `POST请求结果：${JSON.stringify(
                            data,
                            null,
                            2
                        )}`;
                        console.log("POST请求返回数据：", data);
                    })
                    .catch((error) => {
                        console.error("POST请求失败：", error);
                        document.getElementById("postResult").innerText =
                            "POST请求失败：" + error;
                    });
            }
        </script>
    </body>
</html>
